\begin{problem}{1.5.9}
  Let $f(x)$ be a polynomial such that $f(c) = c$. (Recall that a polynomial
  $p(x)$ has $(x-c)^2$ as a factor if and only if both $p(c) = 0$ and $p'(c) = 0$.)
  \begin{enumerate}
    \item If $f'(c) = 1$, show that $(x-c)^2$ is a factor of $g(x) = f(x) - x$.
    \item If $|f'(c)| = 1$, show that $(x-c)^2$ is a factor of $h(x) = f^2(x) - x$.
    \item Show in the case that $f'(c) = -1$, we actually have that $(x-c)^3$ is a
      factor of $h(x) = f^2(x) - x$.
    \item Check that (iii) holds for the non-hyperbolic fixed point $x=2/3$ of the logistic
      map $L_3(x) = 3x(1-x)$.
    \item Check that (i), (ii), (iii) hold for the non-hyperbolic fixed points
      of the polynomial $f(x) = -2x^3 + 2x^2 + x$.
  \end{enumerate}
\end{problem}

\begin{proof}
  \begin{enumerate}
    \item Suppose that $f$ is a polynomial, $c$ is a fixed point of $f$, and that
      $f'(c) = 1$. Let $g(x) = f(x) - x$, a polynomial. Note that $(x-c)^2$ will be a factor
      of $g(x)$ if $g(c) = g'(c) = 0$. Since $f(c) = c$, it is clear that $g(c) = f(c) - c = 0$.
      Note that $g'(x) = f'(x) - 1.$ From our supposition, $f'(c) = 1$ so that $g'(c) = 0$.
      Therefore, $(x-c)^2$ is a factor of $g(x) = f(x) - x.$

    \item Suppose that $f$ is a polynomial, $c$ is a fixed point of $f$, and that
      $| f'(c) |= 1$. Let $h(x) = f^2(x) - x$, a polynomial. Note that $(x-c)^2$ will be a factor
      of $h(x)$ if $h(c) = h'(c) = 0$. Since $f(c) = c$, it is clear that
      $$f^2(c) = f(f(c)) = f(c) = c$$
      and that $h(c) = f^2(c) - c =0$.
      Note that $h'(x) = f'(f(x))f'(x) - 1.$ Thus, since $c$ is a fixed point,
      \begin{align*}
        h'(c) &= f'(f(c))f'(c) - 1 \\
        &= f'(c)^2 - 1 \\
        &= |f'(c)| - 1.
      \end{align*}
      Therefore, from our supposition that $|f'(c)| = 1$, we have that $h'(c) = 0$ and
      $(x-c)^2$ is a factor of $h(x) = f^2(x) - x.$

    \item Suppose that $f$ is a polynomial, $c$ is a fixed point of $f$, and that
      $f'(c) = -1$. Let $h(x) = f^2(x) - x$, a polynomial. Note that $(x-c)^3$ will
      be a factor of $h(x)$ if $h(c) = h'(c) = h''(c) = 0$. By our supposition, we have
      that $|f'(c)| = 1$, so we have already shown previously that $h(c) = h'(c) = 0$ and
      all that remains is to show that $h''(c) = 0$.

      Recall that $h'(x) = f'(f(x))f'(x) - 1$. Thus,
      \begin{align*}
        h''(x) &= \left[f'(f(x))\right]' f'(x) +  f'(f(x))\left[f'(x)\right]'  \\
        &= f''(f(x)) f'(x) f'(x) + f'(f(x))f''(x) \\
        &= f''(f(x)) \left(f'(x)\right)^2 + f''(x) f'(f(x)).
      \end{align*}
      Now, since $f(c) = c$ and $f'(c) = -1$, we have that
      \begin{align*}
        h''(c) &= f''(f(c)) \left(f'(c)\right)^2 + f''(c) f'(f(c)) \\
        &= f''(c) (-1)^2 + f''(c) (-1) \\
        &= 0.
      \end{align*}
      Therefore, $(x-c)^3$ is a factor of $h(x)$.

    \item Suppose that $L_3(x) = 3x(1-x)$ and $h(x) = L_3^2(x) - x$. Thus,
      \begin{align}\label{iv}
        h(x) &= 3(3x(1-x))(1-(3x(1-x))) - x \notag \\
        &= -27x^4 + 54x^3-36x^2 + 9x - x \notag \\
        &= -x \left(x - \frac{2}{3}\right)^3.
      \end{align}
      Note that $x = 2/3$ is a fixed point of $L_3(x)$. Further, we have that
      $L_3'(x) = 3 - 6x$ so that $L_3'(2/3) = -1$. Thus, by the previous results we must
      have that $(x-2/3)^3$ is a factor of $h(x)$. This result    is in agreement with the factorization of $h(x)$ in \eqref{iv}.

    \item Suppose that $f(x) = -2x^3 + 2x^2 + x$ and $g(x) = f(x) - x$. Thus,
      \begin{align}\label{v}
        g(x) &= -2x^3 + 2x^2 + x - x \notag \\
        &= -2x^2(x-1).
      \end{align}
      Recall that $x=0$ and $x=1$ are the non-hyperbolic fixed points of $f(x)$. Note that $f'(x) = -6x + 4x + 1$ so
      that $f'(0) = 1$ and $f'(1) = -1$. By the results shown above, since $f'(0) = 1$, we must have
      that $x^2$ is a factor of $g(x)$. Similarly, since $f'(1) \neq 1$, we must have that $(x-1)^2$ is not a factor
      of $g(x)$. These results are in agreement with the factorization of $g(x)$ in \eqref{v}.

      Now suppose that $f(x) = -2x^3 + 2x^2 + x$ and $h(x) = f^2(x) - x$. Thus,
      \begin{align}\label{factor_v}
        h(x) &= -2\left(-2x^3 + 2x^2 + x\right)^3 + 2\left(-2x^3 + 2x^2 + x\right)^2 + \left(-2x^3 + 2x^2 + x\right) - x \notag \\
        &= 16 x^9 - 48 x^8 + 24 x^7 + 40 x^6 - 28 x^5 - 12 x^4 + 4 x^3 + 4 x^2 + x \notag \\
        &= 4x^2(x-1)^3(4 x^4 - 6 x^2 - 4 x -1 ).
      \end{align}
      As shown previously, the non-hyperbolic fixed points of $f(x)$ are given by $x=0$ and $x=1$ with $f'(0) = 1$ and $f'(1) = -1$.
      By the results above, since $|f'(0)| = 1$, we must have that $x^2$ is a factor of $h(x)$ and since $f'(1) = -1$, we must have
      that $(x-1)^3$ is a factor of $h(x)$. These results are in agreement with the
      factorization of $h(x)$ in \eqref{factor_v}.
  \end{enumerate}
\end{proof}
\newpage
